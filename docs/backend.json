{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the CashCenter.fun platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "username": {
          "type": "string",
          "description": "The user's chosen username."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "currentBalance": {
          "type": "number",
          "description": "The user's current CASH balance.",
          "format": "number"
        },
        "role": {
          "type": "string",
          "description": "The user's role (e.g., 'user', 'admin')."
        }
      },
      "required": [
        "id",
        "username",
        "email",
        "currentBalance",
        "role"
      ]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a transaction that modifies a user's CASH balance.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transaction entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Transaction)"
        },
        "amount": {
          "type": "number",
          "description": "The amount of CASH involved in the transaction."
        },
        "type": {
          "type": "string",
          "description": "The type of transaction (e.g., 'deposit', 'withdrawal', 'offer_completion')."
        },
        "timestamp": {
          "type": "string",
          "description": "The timestamp of the transaction.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "A description of the transaction."
        }
      },
      "required": [
        "id",
        "userId",
        "amount",
        "type",
        "timestamp",
        "description"
      ]
    },
    "Payout": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Payout",
      "type": "object",
      "description": "Represents a user's payout request.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the payout entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Payout)"
        },
        "amount": {
          "type": "number",
          "description": "The amount of CASH requested for payout."
        },
        "payoutAddress": {
          "type": "string",
          "description": "The user's payout address (e.g., crypto wallet address, PayPal email)."
        },
        "status": {
          "type": "string",
          "description": "The status of the payout request (e.g., 'pending', 'processed', 'rejected')."
        },
        "requestTimestamp": {
          "type": "string",
          "description": "The timestamp of the payout request.",
          "format": "date-time"
        },
        "processTimestamp": {
          "type": "string",
          "description": "The timestamp when the payout was processed (if applicable).",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "amount",
        "payoutAddress",
        "status",
        "requestTimestamp"
      ]
    },
    "Offer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Offer",
      "type": "object",
      "description": "Represents a task a user can complete to earn rewards.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the offer." },
        "name": { "type": "string", "description": "The name or title of the offer." },
        "description": { "type": "string", "description": "A brief description of the offer." },
        "reward": { "type": "number", "description": "The amount of CASH rewarded upon completion." },
        "category": { "type": "string", "enum": ["Game", "Survey", "App", "Quiz"], "description": "The category of the offer." },
        "partner": { "type": "string", "description": "The name of the offerwall partner providing the offer." },
        "imageUrl": { "type": "string", "format": "uri", "description": "URL for an image representing the offer." },
        "status": { "type": "string", "enum": ["active", "inactive"], "description": "The current status of the offer." },
        "offerUrl": { "type": "string", "format": "uri", "description": "The URL the user is sent to to complete the offer." }
      },
      "required": ["id", "name", "reward", "category", "partner", "imageUrl", "status", "offerUrl"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": { "$ref": "#/backend/entities/User" },
          "description": "Stores user profiles. Uses path-based ownership for private user data.",
          "params": [{ "name": "userId", "description": "The unique identifier of the user." }]
        }
      },
      {
        "path": "/users/{userId}/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": { "$ref": "#/backend/entities/Transaction" },
          "description": "Stores transaction history for each user. Uses path-based ownership.",
          "params": [
            { "name": "userId", "description": "The unique identifier of the user." },
            { "name": "transactionId", "description": "The unique identifier of the transaction." }
          ]
        }
      },
      {
        "path": "/users/{userId}/payouts/{payoutId}",
        "definition": {
          "entityName": "Payout",
          "schema": { "$ref": "#/backend/entities/Payout" },
          "description": "Stores payout requests for each user. Uses path-based ownership.",
          "params": [
            { "name": "userId", "description": "The unique identifier of the user." },
            { "name": "payoutId", "description": "The unique identifier of the payout request." }
          ]
        }
      },
      {
        "path": "/offers/{offerId}",
        "definition": {
          "entityName": "Offer",
          "schema": { "$ref": "#/backend/entities/Offer" },
          "description": "Stores all available offers from various partners. Publicly readable.",
          "params": [{ "name": "offerId", "description": "The unique identifier for the offer." }]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "AdminRole",
          "schema": { "$ref": "#/backend/entities/User" },
          "description": "Stores admin roles. Existence of a document indicates admin status. No data required in the document.",
          "params": [{ "name": "userId", "description": "The unique identifier of a user." }]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure security, scalability, and debuggability. User data, transactions, and payout requests are stored in separate collections with path-based ownership. The new 'offers' collection is a top-level collection, as offers are public data and do not belong to a specific user, making them easily queryable for all users."
  }
}
